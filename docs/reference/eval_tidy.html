<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Evaluate an expression with quosures and pronoun support — eval_tidy • rlang</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<meta property="og:title" content="Evaluate an expression with quosures and pronoun support — eval_tidy" />

<meta property="og:description" content="eval_tidy() is a variant of base::eval() that powers the tidy
evaluation framework. Like eval() it accepts user data as
argument. If supplied, it evaluates its input expr in a data
mask. In additon eval_tidy() supports:
Quosures. The expression wrapped in the quosure
evaluates in its original context (masked by data if supplied).
Pronouns. If data is supplied, the .env and .data
pronouns are installed in the data mask. .env is a reference to
the calling environment and .data refers to the data argument.
These pronouns lets you be explicit about where to find
values and throw errors if you try to access non-existent values.
" />
<meta name="twitter:card" content="summary" />
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rlang</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../reference/lifecycle.html">Lifecycle</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-lib/rlang">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluate an expression with quosures and pronoun support</h1>
    </div>

    
    <p><code>eval_tidy()</code> is a variant of <code><a href='http://www.rdocumentation.org/packages/base/topics/eval'>base::eval()</a></code> that powers the tidy
evaluation framework. Like <code>eval()</code> it accepts user data as
argument. If supplied, it evaluates its input <code>expr</code> in a <a href='as_data_mask.html'>data
mask</a>. In additon <code>eval_tidy()</code> supports:</p><ul>
<li><p><a href='quotation.html'>Quosures</a>. The expression wrapped in the quosure
evaluates in its original context (masked by <code>data</code> if supplied).</p></li>
<li><p><a href='tidyeval-data.html'>Pronouns</a>. If <code>data</code> is supplied, the <code>.env</code> and <code>.data</code>
pronouns are installed in the data mask. <code>.env</code> is a reference to
the calling environment and <code>.data</code> refers to the <code>data</code> argument.
These pronouns lets you be explicit about where to find
values and throw errors if you try to access non-existent values.</p></li>
</ul>
    

    <pre class="usage"><span class='fu'>eval_tidy</span>(<span class='no'>expr</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>env</span> <span class='kw'>=</span> <span class='fu'><a href='caller_env.html'>caller_env</a></span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>expr</th>
      <td><p>An expression to evaluate.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data frame, or named list or vector. Alternatively, a
data mask created with <code><a href='as_data_mask.html'>as_data_mask()</a></code> or <code><a href='as_data_mask.html'>new_data_mask()</a></code>.</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p>The environment in which to evaluate <code>expr</code>. This
environment is always ignored when evaluating quosures. Quosures
are evaluated in their own environment.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="life-cycle"><a class="anchor" href="#life-cycle"></a>Life cycle</h2>

    
    <p><code>eval_tidy()</code> is stable.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><a href='quasiquotation.html'>quasiquotation</a> for the second leg of the tidy evaluation
framework.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># With simple quoted expressions eval_tidy() works the same way as</span>
<span class='co'># eval():</span>
<span class='no'>apple</span> <span class='kw'>&lt;-</span> <span class='st'>"apple"</span>
<span class='no'>kiwi</span> <span class='kw'>&lt;-</span> <span class='st'>"kiwi"</span>
<span class='no'>expr</span> <span class='kw'>&lt;-</span> <span class='fu'>quote</span>(<span class='fu'>paste</span>(<span class='no'>apple</span>, <span class='no'>kiwi</span>))
<span class='no'>expr</span></div><div class='output co'>#&gt; paste(apple, kiwi)</div><div class='input'>
<span class='fu'>eval</span>(<span class='no'>expr</span>)</div><div class='output co'>#&gt; [1] "apple kiwi"</div><div class='input'><span class='fu'>eval_tidy</span>(<span class='no'>expr</span>)</div><div class='output co'>#&gt; [1] "apple kiwi"</div><div class='input'>
<span class='co'># Both accept a data mask as argument:</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='kw'>apple</span> <span class='kw'>=</span> <span class='st'>"CARROT"</span>, <span class='kw'>kiwi</span> <span class='kw'>=</span> <span class='st'>"TOMATO"</span>)
<span class='fu'>eval</span>(<span class='no'>expr</span>, <span class='no'>data</span>)</div><div class='output co'>#&gt; [1] "CARROT TOMATO"</div><div class='input'><span class='fu'>eval_tidy</span>(<span class='no'>expr</span>, <span class='no'>data</span>)</div><div class='output co'>#&gt; [1] "CARROT TOMATO"</div><div class='input'>

<span class='co'># In addition eval_tidy() has support for quosures:</span>
<span class='no'>with_data</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>data</span>, <span class='no'>expr</span>) {
  <span class='no'>quo</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='quotation.html'>enquo</a></span>(<span class='no'>expr</span>)
  <span class='fu'>eval_tidy</span>(<span class='no'>quo</span>, <span class='no'>data</span>)
}
<span class='fu'>with_data</span>(<span class='kw'>NULL</span>, <span class='no'>apple</span>)</div><div class='output co'>#&gt; [1] "apple"</div><div class='input'><span class='fu'>with_data</span>(<span class='no'>data</span>, <span class='no'>apple</span>)</div><div class='output co'>#&gt; [1] "CARROT"</div><div class='input'><span class='fu'>with_data</span>(<span class='no'>data</span>, <span class='fu'>list</span>(<span class='no'>apple</span>, <span class='no'>kiwi</span>))</div><div class='output co'>#&gt; [[1]]
#&gt; [1] "CARROT"
#&gt; 
#&gt; [[2]]
#&gt; [1] "TOMATO"
#&gt; </div><div class='input'>
<span class='co'># Secondly eval_tidy() installs handy pronouns that allows users to</span>
<span class='co'># be explicit about where to find symbols:</span>
<span class='fu'>with_data</span>(<span class='no'>data</span>, <span class='no'>.data</span>$<span class='no'>apple</span>)</div><div class='output co'>#&gt; [1] "CARROT"</div><div class='input'><span class='fu'>with_data</span>(<span class='no'>data</span>, <span class='no'>.env</span>$<span class='no'>apple</span>)</div><div class='output co'>#&gt; [1] "apple"</div><div class='input'>

# Note that instead of using `.env` it is often equivalent and may
# be preferred to unquote a value. There are two differences. First
# unquoting happens earlier, when the quosure is created. Secondly,
# subsetting `.env` with the `$` operator may be brittle because
# `$` does not look through the parents of the environment.
#
# For instance using `.env$name` in a magrittr pipeline is an
# instance where this poses problem, because the magrittr pipe
# currently (as of v1.5.0) evaluates its operands in a *child* of
# the current environment (this child environment is where it
# defines the pronoun `.`).
</div><span class='co'># NOT RUN {</span>
  <span class='no'>data</span> <span class='kw'>%&gt;%</span> <span class='fu'>with_data</span>(!!<span class='no'>kiwi</span>)     <span class='co'># "kiwi"</span>
  <span class='no'>data</span> <span class='kw'>%&gt;%</span> <span class='fu'>with_data</span>(<span class='no'>.env</span>$<span class='no'>kiwi</span>)  <span class='co'># NULL</span>
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#life-cycle">Life cycle</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Lionel Henry, <a href='http://hadley.nz'>Hadley Wickham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
